# Crime Rate Dataset

Patrick Cullinane
MA-541
May 16th, 2022

```{r setup, include=FALSE} 
knitr::opts_chunk$set(warning = FALSE, message = FALSE) 
```


```{r}
library(dplyr)
library(ggplot2)
library(car)
library(ggpubr)
library(tidyverse)
library(rstatix)
library(ggstatsplot)

setwd("C:/Users/Laura/Documents/code/MA-541")
df <- read.csv("Crime_R.csv")


#str(df)
```

### Introduction

The Crime Rate dataset is comprised of data crime rate and associated variables collected in the United States at two different periods of time. The dataset is broken down into 27 columns and 47 rows. The dataset was developed by the University of Sheffield 

```{r}
dim(df)

names(df)
```

The first 13 columns consist of crime rate data and other measurements taken at a point in time, and the next set consists of the same data taken a decade later. Additionally there is a column called Southern which consists of a binary variable, 1 if a Southern state 0 otherwise. The Southern column applys to both sets of columns within the dataset. We are not told the exact date at which the data has been collected. Overall the data is a mixture of discrete, binary, continuous variables. 

```{r}
# split data into year 0 and year + 10 

df0 <- df %>%
  select(-ends_with('10'))
df10 <- df %>%
  select(ends_with('10'))

head(df0,2)
tail(df0,2)
```

### Experiment 1


The first question we will examine will be whether there is a relationship between Males and Southern states. To accomplish this we will use 3 columns; Southern, Males, and Males10. To analyze differences we will need to engineer Southern variable that corresponds to Males10. The first group of Males at what we will call time 0 will be code "1" if it is a Southern state and "0" if not. In the second group we will use "4" to denote a Southern state and "3" otherwise. In this way we will have 4 groups of Males. Before we perform our testing we will examine the data in more depth. 

The Males and Males10 columns refer to the number of males per 1000 females in the examined state. 

First we will look at how the data is comprised using stem and histogram plots. 


```{r}
df1 <- df[,c("Southern","Males")]
df2 <- df[,c("Southern","Males10")]
stem(df$Southern)
stem(df$Males)
stem(df$Males10)
```

We can see from the stem plots that we have more Southern states. We should note that although it is not explicity stated in the data what constitutes a Southern state the data seems to align with the US census bureau's definition of a Southern state. The US census counts 16 states in total as Southern States, which appears to align with our data. Alternatively we can see there are 31 "0" states which in total make 47 states counted in this dataset. We are not told what comprises the 31 non-Southern states. 

```{r}
sum(df$Southern == 1)
sum(df$Southern == 0)
```

From the stem plots we can see that Males and Males10 both appear to be rightly skewed. We can examaine this in more detail using a histogram. 

```{r}
ggplot(df, aes(x=Males)) + 
 geom_histogram(aes(y=..density..), colour="black", fill="white")+
 geom_density(alpha=.2, fill="#FF6666")

ggplot(df, aes(x=Males10)) + 
 geom_histogram(aes(y=..density..), colour="black", fill="white")+
 geom_density(alpha=.2, fill="#FF6666")
```

More detailed examination with our histograms and density plots again show us that data may be skewed to the right. This will be important to note as we further examine whether there is a difference in means between groups of data. 

With this intuition we will examine using anova whether there is a significant difference in group means. To accomplish this we must first encode our variables as previously described and then stack the data frames on top of eachother. Next we will run an anova test on the data. We formulate the null hypothesis that there is no difference in means between the groups of data and the alternative hypothesis that there is a difference of means. 

```{r}

df2$Southern <- ifelse(df2$Southern == 0, 3,4)
names(df2)[2] <- "Males"

df_stack <- rbind(df1,df2)
df_stack$Southern <- as.factor(df_stack$Southern)

aov_test <- aov(Males ~ Southern, data=df_stack)
summary(aov_test)
```

It appears from the results that we can reject our null hypothesis that the means of the groups are equal. 

Our next step is to perform post-hoc teting to see which groups are different. First though we would like to examine our results in more detail to see what tests we need to perform. 

We examine the residuals of the anova results to see if our data meets the normality assumption needed for tukey or bonferroni. We will do this graphically through a histogram of the residuals and qqplot. 


```{r}

hist(aov_test$residuals)
qqPlot(aov_test$residuals)
```

Graphically it appears that the residuals are not nornally distributed but we need to examine this more formally with a kruskal test


```{r}
kruskal.test(Males ~ Southern, data = df_stack)
```


```{r}
ggbetweenstats(
  data = df_stack,
  x = "Southern",
  y = "Males",
  type = "nonparametric", # ANOVA or Kruskal-Wallis
  plot.type = "box",
  pairwise.comparisons = TRUE,
  pairwise.display = "significant",
  centrality.plotting = FALSE,
  bf.message = FALSE
)

```

```{r}
lm.fit <- lm(CrimeRate ~ ExpenditureYear0, data=df0)
summary(lm.fit)

plot(df0$CrimeRate, df$ExpenditureYear0)
abline(lm.fit, lwd=3, col="red")

par(mfrow = c(2,2))
plot(lm.fit)

```

```{r}
model <- lm(CrimeRate~.,data=df0)
summary(model)

lm.fit <- lm(
  CrimeRate ~ 
    Education + Youth + Wage + BelowWage 
    + ExpenditureYear0, data=df0)

lm.fit2 <- lm(
  CrimeRate ~
    Youth + Wage + BelowWage
    + ExpenditureYear0, data=df0
)

summary(lm.fit)
summary(lm.fit2)

anova(lm.fit, lm.fit2)


```

```{r}
lm.fit3 <- lm(
  CrimeRate ~ 
    + log10(Youth)
    + log10(Wage)
    + log10(BelowWage) 
    + log10(ExpenditureYear0), data=df0
)

lm.fit4 <- lm(
  CrimeRate ~ 
  + log10(Youth)
  + log10(BelowWage) 
  + log10(ExpenditureYear0), data=df0
)

summary(lm.fit3)
summary(lm.fit4)

anova(lm.fit3, lm.fit4)


```

References:

1. www.statstutor.ac.uk
2. US Census


