```{r}
library(dplyr)
library(ggplot2)
library(car)
library(ggpubr)
library(tidyverse)
library(rstatix)
library(ggstatsplot)

setwd("C:/Users/Laura/Documents/code/MA-541")
df <- read.csv("Crime_R.csv")
# split data into year 0 and year + 10 
dim(df)
names(df)
head(df,2)
tail(df,2)

df0 <- df %>%
  select(-ends_with('10'))
df10 <- df %>%
  select(ends_with('10'))

#str(df)
```

```{r}
#str(df0)
#str(df10)

```

```{r}
df2 <- df # temp df to stack dfs

df2$Southern <- ifelse(df2$Southern == 0, 3, 4)

df2$Southern <- as.factor(df2$Southern)
df$Southern <- as.factor(df$Southern)

anova_df <- data.frame(
    rbind(
    as.matrix(df[,c("Southern","Males")])
    , as.matrix(df2[,c("Southern", "Males10")])
  )
)


#anova_df$Southern <- as.factor(anova_df$Southern)
#anova_df <- as.matrix(anova_df)

aov_test <- aov(Males ~ Southern, data=anova_df)
summary(aov_test)

par(mfrow=c(1,2))

hist(aov_test$residuals)
qqPlot(aov_test$residuals)

pwc <- kruskal.test(Males ~ Southern, data = anova_df)

##pwc <- pwc %>% add_xy_position(x = "Southern")
library(ggstatsplot)

ggbetweenstats(
  data = anova_df,
  x = "Southern",
  y = "Males",
  type = "nonparametric", # ANOVA or Kruskal-Wallis
  plot.type = "box",
  pairwise.comparisons = TRUE,
  pairwise.display = "significant",
  centrality.plotting = FALSE,
  bf.message = FALSE
)

```



